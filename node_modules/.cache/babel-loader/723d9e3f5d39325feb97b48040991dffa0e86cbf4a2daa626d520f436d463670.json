{"ast":null,"code":"import axios from 'axios';\nconst API_URL = 'http://127.0.0.1:5000';\nconst axiosInstance = axios.create({\n  baseURL: API_URL,\n  timeout: 10000 // adjust as needed\n});\naxiosInstance.interceptors.request.use(config => {\n  const token = localStorage.getItem('token');\n  const user = localStorage.getItem('user');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  if (user) {\n    config.headers['User-Info'] = user; // Add user information to headers\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\nexport const registerUser = userData => {\n  return axiosInstance.post('/register', userData);\n};\nexport const loginUser = async userData => {\n  try {\n    const response = await axiosInstance.post('/login', userData);\n    console.log(\"API login response:\", response.data); // Tambahkan log\n    localStorage.setItem('token', response.data.access_token);\n    if (response.data.user) {\n      localStorage.setItem('user', JSON.stringify(response.data.user));\n      localStorage.setItem('user_id', response.data.user.user_id); // Set user_id in localStorage\n    } else {\n      localStorage.removeItem('user');\n      localStorage.removeItem('user_id'); // Remove user_id from localStorage\n    }\n    return response;\n  } catch (error) {\n    console.error(\"API login error:\", error);\n    throw error;\n  }\n};\nexport const logoutUser = () => {\n  localStorage.removeItem('token');\n  localStorage.removeItem('user');\n  localStorage.removeItem('user_id');\n  return axiosInstance.post('/logout');\n};\nexport const createEvent = async eventData => {\n  try {\n    const response = await axiosInstance.post('/events', eventData);\n    return response.data;\n  } catch (error) {\n    console.error('Error creating event:', error.response ? error.response.data : error.message);\n    throw error;\n  }\n};\nexport const getEvents = async () => {\n  const response = await axiosInstance.get('/events');\n  return response.data;\n};\nexport const createNote = async noteData => {\n  try {\n    const response = await axiosInstance.post('/notes', noteData);\n    return response.data;\n  } catch (error) {\n    if (error.response && error.response.status === 409) {\n      const response = await axiosInstance.put('/notes', noteData);\n      return response.data;\n    }\n    console.error('Error creating or updating note:', error.response ? error.response.data : error.message);\n    throw error;\n  }\n};\nexport const getNotes = async () => {\n  const response = await axiosInstance.get('/notes');\n  return response.data;\n};\nexport const createReview = async reviewData => {\n  try {\n    const response = await axiosInstance.post('/reviews', reviewData);\n    return response.data;\n  } catch (error) {\n    console.error('Error creating note:', error.response ? error.response.data : error.message);\n    throw error;\n  }\n};\nexport const getReviews = async () => {\n  const response = await axiosInstance.get('/reviews');\n  return response.data;\n};\nexport const getLatestReview = async user_id => {\n  const response = await axiosInstance.get(`/reviews/latest?user_id=${user_id}`);\n  return response.data;\n};","map":{"version":3,"names":["axios","API_URL","axiosInstance","create","baseURL","timeout","interceptors","request","use","config","token","localStorage","getItem","user","headers","Authorization","error","Promise","reject","registerUser","userData","post","loginUser","response","console","log","data","setItem","access_token","JSON","stringify","user_id","removeItem","logoutUser","createEvent","eventData","message","getEvents","get","createNote","noteData","status","put","getNotes","createReview","reviewData","getReviews","getLatestReview"],"sources":["C:/Users/LOQ/Downloads/calenderweb/src/services/Api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_URL = 'http://127.0.0.1:5000';\r\n\r\nconst axiosInstance = axios.create({\r\n  baseURL: API_URL,\r\n  timeout: 10000, // adjust as needed\r\n});\r\n\r\naxiosInstance.interceptors.request.use(\r\n  (config) => {\r\n    const token = localStorage.getItem('token');\r\n    const user = localStorage.getItem('user');\r\n    \r\n    if (token) {\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    if (user) {\r\n      config.headers['User-Info'] = user; // Add user information to headers\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport const registerUser = (userData) => {\r\n  return axiosInstance.post('/register', userData);\r\n};\r\n\r\nexport const loginUser = async (userData) => {\r\n  try {\r\n    const response = await axiosInstance.post('/login', userData);\r\n    console.log(\"API login response:\", response.data); // Tambahkan log\r\n    localStorage.setItem('token', response.data.access_token);\r\n    \r\n    if (response.data.user) {\r\n        localStorage.setItem('user', JSON.stringify(response.data.user));\r\n        localStorage.setItem('user_id', response.data.user.user_id); // Set user_id in localStorage\r\n    } else {\r\n        localStorage.removeItem('user');\r\n        localStorage.removeItem('user_id'); // Remove user_id from localStorage\r\n    }\r\n\r\n    return response;\r\n  } catch (error) {\r\n    console.error(\"API login error:\", error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n\r\nexport const logoutUser = () => {\r\n  localStorage.removeItem('token');\r\n  localStorage.removeItem('user');\r\n  localStorage.removeItem('user_id');\r\n  return axiosInstance.post('/logout');\r\n};\r\n\r\nexport const createEvent = async (eventData) => {\r\n  try {\r\n    const response = await axiosInstance.post('/events', eventData);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Error creating event:', error.response ? error.response.data : error.message);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const getEvents = async () => {\r\n  const response = await axiosInstance.get('/events');\r\n  return response.data;\r\n};\r\n\r\nexport const createNote = async (noteData) => {\r\n  try {\r\n    const response = await axiosInstance.post('/notes', noteData);\r\n    return response.data;\r\n  } catch (error) {\r\n    if (error.response && error.response.status === 409) {\r\n      const response = await axiosInstance.put('/notes', noteData);\r\n      return response.data;\r\n    }\r\n    console.error('Error creating or updating note:', error.response ? error.response.data : error.message);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const getNotes = async () => {\r\n  const response = await axiosInstance.get('/notes');\r\n  return response.data;\r\n};\r\n\r\nexport const createReview = async (reviewData) => {\r\n  try {\r\n    const response = await axiosInstance.post('/reviews', reviewData);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Error creating note:', error.response ? error.response.data : error.message);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const getReviews = async () => {\r\n  const response = await axiosInstance.get('/reviews');\r\n  return response.data;\r\n};\r\n\r\nexport const getLatestReview = async (user_id) => {\r\n  const response = await axiosInstance.get(`/reviews/latest?user_id=${user_id}`);\r\n  return response.data;\r\n};"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,OAAO,GAAG,uBAAuB;AAEvC,MAAMC,aAAa,GAAGF,KAAK,CAACG,MAAM,CAAC;EACjCC,OAAO,EAAEH,OAAO;EAChBI,OAAO,EAAE,KAAK,CAAE;AAClB,CAAC,CAAC;AAEFH,aAAa,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CACnCC,MAAM,IAAK;EACV,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,MAAMC,IAAI,GAAGF,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;EAEzC,IAAIF,KAAK,EAAE;IACTD,MAAM,CAACK,OAAO,CAACC,aAAa,GAAG,UAAUL,KAAK,EAAE;EAClD;EACA,IAAIG,IAAI,EAAE;IACRJ,MAAM,CAACK,OAAO,CAAC,WAAW,CAAC,GAAGD,IAAI,CAAC,CAAC;EACtC;EACA,OAAOJ,MAAM;AACf,CAAC,EACAO,KAAK,IAAK;EACT,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;AAED,OAAO,MAAMG,YAAY,GAAIC,QAAQ,IAAK;EACxC,OAAOlB,aAAa,CAACmB,IAAI,CAAC,WAAW,EAAED,QAAQ,CAAC;AAClD,CAAC;AAED,OAAO,MAAME,SAAS,GAAG,MAAOF,QAAQ,IAAK;EAC3C,IAAI;IACF,MAAMG,QAAQ,GAAG,MAAMrB,aAAa,CAACmB,IAAI,CAAC,QAAQ,EAAED,QAAQ,CAAC;IAC7DI,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEF,QAAQ,CAACG,IAAI,CAAC,CAAC,CAAC;IACnDf,YAAY,CAACgB,OAAO,CAAC,OAAO,EAAEJ,QAAQ,CAACG,IAAI,CAACE,YAAY,CAAC;IAEzD,IAAIL,QAAQ,CAACG,IAAI,CAACb,IAAI,EAAE;MACpBF,YAAY,CAACgB,OAAO,CAAC,MAAM,EAAEE,IAAI,CAACC,SAAS,CAACP,QAAQ,CAACG,IAAI,CAACb,IAAI,CAAC,CAAC;MAChEF,YAAY,CAACgB,OAAO,CAAC,SAAS,EAAEJ,QAAQ,CAACG,IAAI,CAACb,IAAI,CAACkB,OAAO,CAAC,CAAC,CAAC;IACjE,CAAC,MAAM;MACHpB,YAAY,CAACqB,UAAU,CAAC,MAAM,CAAC;MAC/BrB,YAAY,CAACqB,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC;IACxC;IAEA,OAAOT,QAAQ;EACjB,CAAC,CAAC,OAAOP,KAAK,EAAE;IACdQ,OAAO,CAACR,KAAK,CAAC,kBAAkB,EAAEA,KAAK,CAAC;IACxC,MAAMA,KAAK;EACb;AACF,CAAC;AAGD,OAAO,MAAMiB,UAAU,GAAGA,CAAA,KAAM;EAC9BtB,YAAY,CAACqB,UAAU,CAAC,OAAO,CAAC;EAChCrB,YAAY,CAACqB,UAAU,CAAC,MAAM,CAAC;EAC/BrB,YAAY,CAACqB,UAAU,CAAC,SAAS,CAAC;EAClC,OAAO9B,aAAa,CAACmB,IAAI,CAAC,SAAS,CAAC;AACtC,CAAC;AAED,OAAO,MAAMa,WAAW,GAAG,MAAOC,SAAS,IAAK;EAC9C,IAAI;IACF,MAAMZ,QAAQ,GAAG,MAAMrB,aAAa,CAACmB,IAAI,CAAC,SAAS,EAAEc,SAAS,CAAC;IAC/D,OAAOZ,QAAQ,CAACG,IAAI;EACtB,CAAC,CAAC,OAAOV,KAAK,EAAE;IACdQ,OAAO,CAACR,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAACO,QAAQ,GAAGP,KAAK,CAACO,QAAQ,CAACG,IAAI,GAAGV,KAAK,CAACoB,OAAO,CAAC;IAC5F,MAAMpB,KAAK;EACb;AACF,CAAC;AAED,OAAO,MAAMqB,SAAS,GAAG,MAAAA,CAAA,KAAY;EACnC,MAAMd,QAAQ,GAAG,MAAMrB,aAAa,CAACoC,GAAG,CAAC,SAAS,CAAC;EACnD,OAAOf,QAAQ,CAACG,IAAI;AACtB,CAAC;AAED,OAAO,MAAMa,UAAU,GAAG,MAAOC,QAAQ,IAAK;EAC5C,IAAI;IACF,MAAMjB,QAAQ,GAAG,MAAMrB,aAAa,CAACmB,IAAI,CAAC,QAAQ,EAAEmB,QAAQ,CAAC;IAC7D,OAAOjB,QAAQ,CAACG,IAAI;EACtB,CAAC,CAAC,OAAOV,KAAK,EAAE;IACd,IAAIA,KAAK,CAACO,QAAQ,IAAIP,KAAK,CAACO,QAAQ,CAACkB,MAAM,KAAK,GAAG,EAAE;MACnD,MAAMlB,QAAQ,GAAG,MAAMrB,aAAa,CAACwC,GAAG,CAAC,QAAQ,EAAEF,QAAQ,CAAC;MAC5D,OAAOjB,QAAQ,CAACG,IAAI;IACtB;IACAF,OAAO,CAACR,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAACO,QAAQ,GAAGP,KAAK,CAACO,QAAQ,CAACG,IAAI,GAAGV,KAAK,CAACoB,OAAO,CAAC;IACvG,MAAMpB,KAAK;EACb;AACF,CAAC;AAED,OAAO,MAAM2B,QAAQ,GAAG,MAAAA,CAAA,KAAY;EAClC,MAAMpB,QAAQ,GAAG,MAAMrB,aAAa,CAACoC,GAAG,CAAC,QAAQ,CAAC;EAClD,OAAOf,QAAQ,CAACG,IAAI;AACtB,CAAC;AAED,OAAO,MAAMkB,YAAY,GAAG,MAAOC,UAAU,IAAK;EAChD,IAAI;IACF,MAAMtB,QAAQ,GAAG,MAAMrB,aAAa,CAACmB,IAAI,CAAC,UAAU,EAAEwB,UAAU,CAAC;IACjE,OAAOtB,QAAQ,CAACG,IAAI;EACtB,CAAC,CAAC,OAAOV,KAAK,EAAE;IACdQ,OAAO,CAACR,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAACO,QAAQ,GAAGP,KAAK,CAACO,QAAQ,CAACG,IAAI,GAAGV,KAAK,CAACoB,OAAO,CAAC;IAC3F,MAAMpB,KAAK;EACb;AACF,CAAC;AAED,OAAO,MAAM8B,UAAU,GAAG,MAAAA,CAAA,KAAY;EACpC,MAAMvB,QAAQ,GAAG,MAAMrB,aAAa,CAACoC,GAAG,CAAC,UAAU,CAAC;EACpD,OAAOf,QAAQ,CAACG,IAAI;AACtB,CAAC;AAED,OAAO,MAAMqB,eAAe,GAAG,MAAOhB,OAAO,IAAK;EAChD,MAAMR,QAAQ,GAAG,MAAMrB,aAAa,CAACoC,GAAG,CAAC,2BAA2BP,OAAO,EAAE,CAAC;EAC9E,OAAOR,QAAQ,CAACG,IAAI;AACtB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}